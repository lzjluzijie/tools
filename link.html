<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.4/css/bulma.min.css"
          integrity="sha256-8B1OaG0zT7uYA572S2xOxWACq9NXYPQ+U5kHPV1bJN4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/FortAwesome/Font-Awesome@5.7.2/css/all.min.css"
          integrity="sha256-7V33osRIfrDP7o1DzMbHKTFApfEDTIyCywe0imdN8no=" crossorigin="anonymous">
    <title>Tools by Halulu</title>
    <meta name="keywords" content="哈陆lu,halulu,tools,online,hash">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-91028451-12"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'UA-91028451-12');
    </script>

</head>
<body>
<nav class="navbar" role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
        <a class="navbar-item" href="/">
            <img alt="halulu" src="https://halu.lu/halulu.png" width="30" height="30"><strong>Tools</strong>
        </a>
    </div>

    <div id="navbar-menu" class="navbar-menu">
        <div class="navbar-start">
            <a class="navbar-item" id="navbar-hash" href="/hash.html">
                Hash
            </a>

            <a class="navbar-item" id="navbar-hash" href="/encode.html">
                Encode
            </a>
        </div>

        <div class="navbar-end">
            <a class="navbar-item" id="navbar-todo" href="/todo.html">
                TODO
            </a>

            <a class="navbar-item" id="navbar-halulu" href="https://halu.lu/"
               target="_blank">Halulu</a>

            <div class="navbar-item" id="navbar-github">
                <a href="https://github.com/lzjluzijie/tools">
                    <i class="fab fa-github fa-2x"></i>
                </a>
            </div>
        </div>
    </div>
</nav>
<section class="section" id="link">
    <div class="container">
        <div class="control">
            <input class="input" type="text" v-model="input" placeholder="Sharing URL here">
        </div>

        <br>

        <div class="content control">
            <p id="output" class="content" v-bind:data-clipboard-text="output" style="word-wrap:break-word">
                Direct URL: {{ output }}
            </p>
        </div>
    </div>
</section>
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.8/dist/vue.min.js"
        integrity="sha256-GN7NvWruk083BKn+djXpMOuWnd9Rz70hQgF868IIyTU=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js"
        integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>
<script>
    var link = new Vue({
        el: '#link',
        data: {
            input: '',
        },
        computed: {
            output: function () {
                try {
                    let input = this.input;
                    let url = new URL(input);
                    let host = url.host;
                    if (host.slice(-14) === "sharepoint.com") {
                        url.searchParams.set("download", "1");
                        return url.toString()
                    } else if (host.slice(-7) === "1drv.ms" || host.slice(-17) === "onedrive.live.com") {
                        return "https://api.onedrive.com/v1.0/shares/u!" + window.btoa(input).replace(/\+/g, '-').replace(/\//g, '_').replace(/\=+$/, '') + "/root/content"
                    } else {
                        return "unknown url"
                    }
                } catch (e) {
                    return ""
                }
            }
        },
    });

    new ClipboardJS(document.getElementById('output'));
</script>
</body>
</html>